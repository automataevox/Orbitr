id: grafana
name: Grafana
author: Orbitr Team
description: Grafana is the open source analytics and monitoring platform.
type: tool
version: 10.2.0
icon: https://cdn.jsdelivr.net/gh/devicons/devicon/icons/grafana/grafana-original.svg
repository: https://github.com/orbitr/extensions/tree/main/grafana
tags:
  - monitoring
  - analytics
  - visualization
  - metrics

environment:
  - name: GF_SECURITY_ADMIN_USER
    label: Admin Username
    description: Grafana admin username
    type: string
    required: false
    default: "admin"

  - name: GF_SECURITY_ADMIN_PASSWORD
    label: Admin Password
    description: Grafana admin password
    type: string
    required: true
    secret: true

  - name: GF_INSTALL_PLUGINS
    label: Plugins
    description: Comma-separated list of plugins to install
    type: string
    required: false
    default: ""

volumes:
  - container: /var/lib/grafana
    description: Grafana data directory

ports:
  - container: 3000
    host: 3000
    protocol: tcp
    description: Grafana web interface

healthCheck:
  type: http
  endpoint: /api/health
  port: 3000
  interval: 30
  timeout: 10
  retries: 3

proxyPresets:
  - subdomain: grafana
    targetPort: 3000
    sslEnabled: true

requirements:
  minMemory: 256
  minCpu: 0.5

compose:
  version: "3.8"
  services:
    grafana:
      image: grafana/grafana:10.2.0
      environment:
        GF_SECURITY_ADMIN_USER: ${GF_SECURITY_ADMIN_USER}
        GF_SECURITY_ADMIN_PASSWORD: ${GF_SECURITY_ADMIN_PASSWORD}
        GF_INSTALL_PLUGINS: ${GF_INSTALL_PLUGINS}
      volumes:
        - grafana_data:/var/lib/grafana
      ports:
        - "3000:3000"
      restart: unless-stopped
      healthcheck:
        test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:3000/api/health"]
        interval: 30s
        timeout: 10s
        retries: 3
  volumes:
    grafana_data:
